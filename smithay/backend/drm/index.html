<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module represents abstraction on top the linux direct rendering manager api (drm)."><title>smithay::backend::drm - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-e56847b5.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="smithay" data-themes="" data-resource-suffix="" data-rustdoc-version="1.92.0-nightly (7ac0330c6 2025-09-25)" data-channel="nightly" data-search-js="search-e256b49e.js" data-stringdex-js="stringdex-061df703.js" data-settings-js="settings-c38705f0.js" ><script src="../../../static.files/storage-e2aeef58.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-ce535bd0.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Module drm</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../smithay/index.html">smithay</a><span class="version">0.7.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module drm</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#drmdevice" title="`DrmDevice`"><code>DrmDevice</code></a></li><li><a href="#drmsurface" title="`DrmSurface`"><code>DrmSurface</code></a></li><li><a href="#rendering" title="Rendering">Rendering</a><ul><li><a href="#hardware-composition" title="Hardware composition">Hardware composition</a></li></ul></li><li><a href="#drmnode" title="`DrmNode`"><code>DrmNode</code></a></li></ul><h3><a href="#modules">Module Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#traits" title="Traits">Traits</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In smithay::<wbr>backend</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">smithay</a>::<wbr><a href="../index.html">backend</a></div><h1>Module <span>drm</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/smithay/backend/drm/mod.rs.html#1-518">Source</a> </span></div><span class="item-info"><div class="stab portability">Available on <strong>crate feature <code>backend_drm</code></strong> only.</div></span><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module represents abstraction on top the linux direct rendering manager api (drm).</p>
<h3 id="drmdevice"><a class="doc-anchor" href="#drmdevice">§</a><a href="struct.DrmDevice.html" title="struct smithay::backend::drm::DrmDevice"><code>DrmDevice</code></a></h3>
<p>A device exposes certain properties, which are directly derived
from the <em>device</em> as perceived by the direct rendering manager api (drm). These resources consists
out of:</p>
<ul>
<li><a href="../../../drm/control/connector/index.html" title="mod drm::control::connector"><code>connectors</code></a> represents a port on your computer, possibly with a connected monitor, TV, capture card, etc.</li>
<li><a href="../../../drm/control/encoder/index.html" title="mod drm::control::encoder"><code>encoder</code></a> encodes the data of connected crtcs into a video signal for a fixed set of connectors.
E.g. you might have an analog encoder based on a DAG for VGA ports, but another one for digital ones.
Also not every encoder might be connected to every crtc.</li>
<li><a href="../../../drm/control/framebuffer/index.html" title="mod drm::control::framebuffer"><code>framebuffer</code></a> represents a buffer you may display, see <code>DrmSurface</code> below.</li>
<li><a href="../../../drm/control/plane/index.html" title="mod drm::control::plane"><code>plane</code></a> adds another layer on top of the crtcs, which allow us to layer multiple images on top of each other more efficiently
then by combining the rendered images in the rendering phase, e.g. via OpenGL. Planes have to be explicitly used by the user to be useful.
Every device has at least one primary plane used to display an image to the whole crtc. Additionally cursor and overlay planes may be present.
Cursor planes are usually very restricted in size and meant to be used for hardware cursors, while overlay planes may
be used for performance reasons to display any overlay on top of the image, e.g. the top-most windows.
Overlay planes may have a bunch of weird limitation, that you cannot query, e.g. only working on round pixel coordinates.
You code should never rely on a fixed set of overlay planes, but always have a fallback solution in place.</li>
<li><a href="../../../drm/control/crtc/index.html" title="mod drm::control::crtc"><code>crtc</code></a>s represent scanout engines of the device pointer to one framebuffer.
Their responsibility is to read the data of the framebuffer and export it into an “Encoder”.
The number of crtc’s represent the number of independent output devices the hardware may handle.</li>
</ul>
<p>On modern graphic cards it is better to think about the <code>crtc</code> as some sort of rendering engine.
You can only have so many different pictures, you may display, as you have <code>crtc</code>s, but a single image
may be put onto multiple displays.</p>
<p>The main functionality of a <code>Device</code> in smithay is to give access to all these properties for the user to
choose an appropriate rendering configuration. What that means is defined by the requirements and constraints documented
in the specific device implementations. The second functionality is the creation of a <code>Surface</code>.
Surface creation requires a <code>crtc</code> (which cannot be the same as another existing <code>Surface</code>’s crtc), a plane,
as well as a <code>Mode</code> and a set of <code>connectors</code>.</p>
<p>smithay does not make sure that <code>connectors</code> are not already in use by another <code>Surface</code>. Overlapping <code>connector</code>-Sets may
be an error or result in undefined rendering behavior depending on the <code>Surface</code> implementation.</p>
<h3 id="drmsurface"><a class="doc-anchor" href="#drmsurface">§</a><a href="struct.DrmSurface.html" title="struct smithay::backend::drm::DrmSurface"><code>DrmSurface</code></a></h3>
<p>A surface is a part of a <code>Device</code> that may output a picture to a number of connectors. It pumps pictures of buffers to outputs.</p>
<p>On surface creation a matching encoder for your <code>connector</code> is automatically selected, if one exists(!),
which means you still need to check your configuration beforehand, even if you do not need to provide an encoder.</p>
<p>A surface consists of one <code>crtc</code> that is rendered to by the user. This is fixed for the <code>Surface</code>s lifetime and cannot be changed.
A surface also always needs at least one connector to output the resulting image to as well as a <code>Mode</code> that is valid for the given connectors.</p>
<p>The state of a <code>Surface</code> is double-buffered, meaning all operations that chance the set of <code>connector</code>s or their <code>Mode</code> are stored and
only applied on the next commit. <code>Surface</code>s do their best to validate these changes, if possible.</p>
<p>A commit/page_flip may be triggered to apply the pending state.</p>
<h3 id="rendering"><a class="doc-anchor" href="#rendering">§</a>Rendering</h3>
<p>The drm infrastructure makes no assumptions about the used renderer and does not interface with them directly.
It just provides a way to create framebuffers from various buffer types (mainly <code>DumbBuffer</code>s and hardware-backed gbm <code>BufferObject</code>s).</p>
<p>Buffer management and details about the various types can be found in the <a href="../allocator/index.html" title="mod smithay::backend::allocator"><code>allocator</code>-Module</a> and
rendering abstractions, which can target these buffers can be found in the <a href="../renderer/index.html" title="mod smithay::backend::renderer"><code>renderer</code>-Module</a>.</p>
<h4 id="hardware-composition"><a class="doc-anchor" href="#hardware-composition">§</a>Hardware composition</h4>
<p>The <a href="compositor/struct.DrmCompositor.html" title="struct smithay::backend::drm::compositor::DrmCompositor"><code>DrmCompositor</code></a> provides a simplified way to utilize drm planes for
using hardware composition.
See the <a href="compositor/index.html" title="mod smithay::backend::drm::compositor"><code>compositor</code></a> module docs for more information on that topic.</p>
<h3 id="drmnode"><a class="doc-anchor" href="#drmnode">§</a><a href="struct.DrmNode.html" title="struct smithay::backend::drm::DrmNode"><code>DrmNode</code></a></h3>
<p>A drm node refers to a drm device and the capabilities that may be performed using the node.
Generally <a href="struct.DrmNode.html" title="struct smithay::backend::drm::DrmNode"><code>DrmNode</code></a> is primarily used by clients (such as the output backends) which need
to allocate buffers for use in X11 or Wayland. If you need to do mode setting, you should use
<a href="struct.DrmDevice.html" title="struct smithay::backend::drm::DrmDevice"><code>DrmDevice</code></a> instead.</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><dl class="item-table"><dt><a class="mod" href="compositor/index.html" title="mod smithay::backend::drm::compositor">compositor</a><wbr><span class="stab portability" title="Available on crate features `wayland_frontend` and `backend_gbm` only"><code>wayland_frontend</code> and <code>backend_gbm</code></span></dt><dd>Composition for <a href="../renderer/element/trait.Element.html" title="trait smithay::backend::renderer::element::Element"><code>Element</code></a>s using drm planes</dd><dt><a class="mod" href="dumb/index.html" title="mod smithay::backend::drm::dumb">dumb</a></dt><dd>Utilities to attach <a href="../../../drm/control/framebuffer/struct.Handle.html" title="struct drm::control::framebuffer::Handle"><code>framebuffer::Handle</code></a>s to dumb buffers</dd><dt><a class="mod" href="exporter/index.html" title="mod smithay::backend::drm::exporter">exporter</a></dt><dd>Trait and data structures to describe types, that can be exported to a drm framebuffer</dd><dt><a class="mod" href="gbm/index.html" title="mod smithay::backend::drm::gbm">gbm</a><wbr><span class="stab portability" title="Available on crate feature `backend_gbm` only"><code>backend_gbm</code></span></dt><dd>Utilities to attach <a href="../../../drm/control/framebuffer/struct.Handle.html" title="struct drm::control::framebuffer::Handle"><code>framebuffer::Handle</code></a>s to gbm backed buffers</dd><dt><a class="mod" href="output/index.html" title="mod smithay::backend::drm::output">output</a><wbr><span class="stab portability" title="Available on crate features `wayland_frontend` and `backend_gbm` only"><code>wayland_frontend</code> and <code>backend_gbm</code></span></dt><dd>Device-wide synchronization helpers</dd></dl><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.DrmAccessError.html" title="struct smithay::backend::drm::DrmAccessError">DrmAccess<wbr>Error</a></dt><dd>DRM access error</dd><dt><a class="struct" href="struct.DrmDevice.html" title="struct smithay::backend::drm::DrmDevice">DrmDevice</a></dt><dd>An open drm device</dd><dt><a class="struct" href="struct.DrmDeviceFd.html" title="struct smithay::backend::drm::DrmDeviceFd">DrmDevice<wbr>Fd</a></dt><dd>Ref-counted file descriptor of an open drm device</dd><dt><a class="struct" href="struct.DrmDeviceNotifier.html" title="struct smithay::backend::drm::DrmDeviceNotifier">DrmDevice<wbr>Notifier</a></dt><dd>Even source of <a href="struct.DrmDevice.html" title="struct smithay::backend::drm::DrmDevice"><code>DrmDevice</code></a></dd><dt><a class="struct" href="struct.DrmEventMetadata.html" title="struct smithay::backend::drm::DrmEventMetadata">DrmEvent<wbr>Metadata</a></dt><dd>Timing metadata for page-flip events</dd><dt><a class="struct" href="struct.DrmNode.html" title="struct smithay::backend::drm::DrmNode">DrmNode</a></dt><dd>A node which refers to a DRM device.</dd><dt><a class="struct" href="struct.DrmSurface.html" title="struct smithay::backend::drm::DrmSurface">DrmSurface</a></dt><dd>An open crtc + plane combination that can be used for scan-out</dd><dt><a class="struct" href="struct.GbmBufferedSurface.html" title="struct smithay::backend::drm::GbmBufferedSurface">GbmBuffered<wbr>Surface</a><wbr><span class="stab portability" title="Available on crate feature `backend_gbm` only"><code>backend_gbm</code></span></dt><dd>Simplified abstraction of a swapchain for gbm-buffers displayed on a <a href="struct.DrmSurface.html" title="struct smithay::backend::drm::DrmSurface"><code>DrmSurface</code></a>.</dd><dt><a class="struct" href="struct.PlaneClaim.html" title="struct smithay::backend::drm::PlaneClaim">Plane<wbr>Claim</a></dt><dd>A claim of a plane</dd><dt><a class="struct" href="struct.PlaneConfig.html" title="struct smithay::backend::drm::PlaneConfig">Plane<wbr>Config</a></dt><dd>Configuration for a single plane</dd><dt><a class="struct" href="struct.PlaneDamageClips.html" title="struct smithay::backend::drm::PlaneDamageClips">Plane<wbr>Damage<wbr>Clips</a></dt><dd>Helper for <code>FB_DAMAGE_CLIPS</code></dd><dt><a class="struct" href="struct.PlaneInfo.html" title="struct smithay::backend::drm::PlaneInfo">Plane<wbr>Info</a></dt><dd>Info about a single plane</dd><dt><a class="struct" href="struct.PlaneState.html" title="struct smithay::backend::drm::PlaneState">Plane<wbr>State</a></dt><dd>State of a single plane</dd><dt><a class="struct" href="struct.Planes.html" title="struct smithay::backend::drm::Planes">Planes</a></dt><dd>A set of planes as supported by a crtc</dd><dt><a class="struct" href="struct.WeakDrmDeviceFd.html" title="struct smithay::backend::drm::WeakDrmDeviceFd">Weak<wbr>DrmDevice<wbr>Fd</a></dt><dd>Weak variant of <a href="struct.DrmDeviceFd.html" title="struct smithay::backend::drm::DrmDeviceFd"><code>DrmDeviceFd</code></a></dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.CreateDrmNodeError.html" title="enum smithay::backend::drm::CreateDrmNodeError">Create<wbr>DrmNode<wbr>Error</a></dt><dd>An error that may occur when creating a <a href="struct.DrmNode.html" title="struct smithay::backend::drm::DrmNode"><code>DrmNode</code></a> from a file descriptor.</dd><dt><a class="enum" href="enum.DrmError.html" title="enum smithay::backend::drm::DrmError">DrmError</a></dt><dd>Errors thrown by the <a href="struct.DrmDevice.html" title="struct smithay::backend::drm::DrmDevice"><code>DrmDevice</code></a>
and the <a href="struct.DrmSurface.html" title="struct smithay::backend::drm::DrmSurface"><code>DrmSurface</code></a>.</dd><dt><a class="enum" href="enum.DrmEvent.html" title="enum smithay::backend::drm::DrmEvent">DrmEvent</a></dt><dd>Events that can be generated by a DrmDevice</dd><dt><a class="enum" href="enum.DrmEventTime.html" title="enum smithay::backend::drm::DrmEventTime">DrmEvent<wbr>Time</a></dt><dd>Either a realtime or monotonic timestamp</dd><dt><a class="enum" href="enum.GbmBufferedSurfaceError.html" title="enum smithay::backend::drm::GbmBufferedSurfaceError">GbmBuffered<wbr>Surface<wbr>Error</a><wbr><span class="stab portability" title="Available on crate feature `backend_gbm` only"><code>backend_gbm</code></span></dt><dd>Errors thrown by a <a href="struct.GbmBufferedSurface.html" title="struct smithay::backend::drm::GbmBufferedSurface"><code>GbmBufferedSurface</code></a></dd><dt><a class="enum" href="enum.NodeType.html" title="enum smithay::backend::drm::NodeType">Node<wbr>Type</a></dt><dd>A type of node</dd><dt><a class="enum" href="enum.VrrSupport.html" title="enum smithay::backend::drm::VrrSupport">VrrSupport</a></dt><dd>VRR support state</dd></dl><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><dl class="item-table"><dt><a class="trait" href="trait.Framebuffer.html" title="trait smithay::backend::drm::Framebuffer">Framebuffer</a></dt><dd>Common framebuffer operations</dd></dl></section></div></main></body></html>